import re
import requests

# Function to extract URLs from the #EXTM3U line with url-tvg=
def extract_urls_from_m3u(m3u_file):
    urls = []  # List to store all URLs found
    url_pattern = r'url-tvg="([^"]+)"'  # Regular expression to match url-tvg= URLs

    # Read the M3U file and extract URLs
    with open(m3u_file, 'r', encoding='utf-8') as file:
        for line in file:
            match = re.search(url_pattern, line)
            if match:
                urls.append(match.group(1))  # Add the URL to the list

    return urls

# Function to test if a URL is reachable
def test_url(url):
    try:
        response = requests.get(url, timeout=5)  # Send GET request with a 5-second timeout
        if response.status_code == 200:
            return f"URL '{url}' is reachable."
        else:
            return f"URL '{url}' returned status code {response.status_code}."
    except requests.exceptions.RequestException as e:
        return f"URL '{url}' is not reachable. Error: {e}"

# Function to test all URLs in the list and print the results
def test_urls(m3u_file):
    urls = extract_urls_from_m3u(m3u_file)  # Extract URLs from the M3U file

    if not urls:
        print("No URLs found in the M3U file.")
        return

    # Test each URL and print the result
    for url in urls:
        result = test_url(url)
        print(result)

# Main script
m3u_file = 'JAPONESE'  # Path to the input M3U file

# Test URLs from the JAPONESE M3U file
test_urls(m3u_file)
